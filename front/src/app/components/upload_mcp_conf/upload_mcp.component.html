<div class="upload-container">

  <!-- Close button -->
  <button class="backButton" id="backButton" (click)="cerrar()">✕</button>

  <h1>Send MCP.JSON</h1>

  <!-- ----------  Mode toggle (checkbox)  ---------- -->
  <div class="checkbox-wrapper">
    <label>
      <input
        type="checkbox"
        [(ngModel)]="useFile"
        (change)="onUseFileChange()" />
      <span>Upload file instead of typing JSON</span>
    </label>
  </div>

  <!-- ----------  Drop zone (file mode)  ---------- -->
  <div
    *ngIf="useFile"
    id="dropzone"
    class="dropzone"
    (click)="openFileDialog()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)">
    <span *ngIf="file">{{ file.name }}</span>
    <span *ngIf="!file && jsonInput">JSON text detected – click to upload</span>
    <span *ngIf="!file && !jsonInput">Drag & Drop JSON file or click to select</span>
  </div>

  <!-- ----------  Hidden File Input  ---------- -->
  <input
    type="file"
    #fileInput
    accept=".json"
    (change)="handleFileInput($event)"
    style="display:none;">

  <!-- ----------  Textarea (preview or manual)  ---------- -->
  <div
    *ngIf="!useFile || showPreview"
    class="json-textarea-wrapper">
    <label for="jsonTextarea">JSON content:</label>
    <textarea
      id="jsonTextarea"
      #jsonTextarea
      [(ngModel)]="jsonInput"
      rows="10"
      placeholder='
            "math": {
              "url": "http://localhost:8000/mcp/",
              "transport": "sse",
            },
            "weather": {
              "url": "http://localhost:8000/mcp/",
              "transport": "streamable_http",
            }'>
    </textarea>
  </div>



  <!-- ----------  Submit button  ---------- -->
  <button
    type="submit"
    id="uploadButton"
    (click)="uploadFiles()"
    [disabled]="isLoading"
    [ngStyle]="{
      backgroundColor: isLoading ? '#666' : '#32567c',
      cursor: isLoading ? 'not-allowed' : 'pointer'
    }">
    Upload
  </button>

  <!-- ----------  Loader  ---------- -->
  <div class="loader-container" *ngIf="isLoading">
    <div class="circle-loader">
      <div class="circle"></div>
    </div>
  </div>

</div>