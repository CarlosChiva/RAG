<div class="input-area">
<ng-container *ngIf="toolExists; else showAddButton">
  <div class="button-group">
    <!-- Botón con dropdown -->
    <div class="dropdown-container">
      <button
        id="dropdownButton"
        (click)="toggleDropdown()"
        class="dropdownBttn"
        [class.active]="isDropdownOpen">
        ▼
      </button>
            
      <ul *ngIf="isDropdownOpen" 
          class="dropdown-menu" 
          [class.dropdown-up]="dropdownDirection === 'up'"
          [class.dropdown-down]="dropdownDirection === 'down'">
        <li (click)="selectOption('image')">Image</li>
        <li (click)="selectOption('mcp')">MCP</li>
      </ul>
    </div>

    <!-- Botón Image toggleable -->
    <button
      id="imageToggleButton"
      (click)="toggleImageSelection()"
      class="imageToggleBttn"
      [class.selected]="isToolSelected">
      {{ toolSelected }}
    </button>
    
  </div>
</ng-container>

<ng-template #showAddButton>
  <div class="dropdown-container">
    <button
      id="dropdownButton"
      (click)="toggleDropdown()"
      class="dropdownBttn"
      [class.active]="isDropdownOpen">
      ▼
    </button>
            
    <ul *ngIf="isDropdownOpen" 
        class="dropdown-menu" 
        [class.dropdown-up]="dropdownDirection === 'up'"
        [class.dropdown-down]="dropdownDirection === 'down'">
      <li (click)="selectOption('image')">Image</li>
      <li (click)="selectOption('mcp')">MCP</li>

    </ul>
  </div>
</ng-template>

  <input 
    type="text" 
    class="input-text"
    [placeholder]="placeholder"
    [value]="message"
    [disabled]="disabled"
    (input)="onInputChange($event)" 
    (keydown)="onKeyDown($event)"
    #inputText>
  <button 
    class="send-button"
    (click)="onSendMessage()" 
    [disabled]="isSending || disabled || !message.trim()">
    <div class="spinner" *ngIf="isSending"></div>
    <span *ngIf="!isSending">{{ sendButtonText }}</span>
  </button>
</div>