<div class="input-area">
<ng-container *ngIf="isToolSelected ; else showAddButton">
  <div class="button-group">
    <!-- Botón con dropdown -->
    <div class="dropdown-container">
      <button
        id="dropdownButton"
        (click)="toggleDropdown()"
        class="dropdownBttn"
        [class.active]="isDropdownOpen">
        ▼
      </button>
            
      <ul *ngIf="isDropdownOpen" 
          class="dropdown-menu" 
          [class.dropdown-up]="dropdownDirection === 'up'"
          [class.dropdown-down]="dropdownDirection === 'down'">
            <!-- 1. Opción Image -->
        <li (click)="selectOption('image')" class="dropdown-item">
          <span>Image</span>
          <!-- Botón Edit solo si hay config -->
          <button *ngIf="hasImageConfig()" 
                  class="edit-btn" 
                  (click)="onEditTool('image'); $event.stopPropagation()">
            ⚙
          </button>
        </li>

        <!-- 2. Opción MCP -->
        <li (click)="selectOption('mcp')" class="dropdown-item">
          <span>MCP</span>
          <button *ngIf="hasMcpConfig()" 
                  class="edit-btn" 
                  (click)="onEditTool('mcp'); $event.stopPropagation()">
            ⚙
          </button>
        </li>
      </ul>
    </div>

    <!-- Botón Image toggleable -->
    <button
      id="toolToggleButton"
      (click)="toggleToolSelected()"
      class="toolToggleBttn"
      [class.selected]="isToolSelected">
      {{ toolSelected }}
    </button>
    
  </div>
</ng-container>

<ng-template #showAddButton>
  <div class="dropdown-container">
    <button
      id="dropdownButton"
      (click)="toggleDropdown()"
      class="dropdownBttn"
      [class.active]="isDropdownOpen">
      ▼
    </button>
            
   <ul *ngIf="isDropdownOpen" 
          class="dropdown-menu" 
          [class.dropdown-up]="dropdownDirection === 'up'"
          [class.dropdown-down]="dropdownDirection === 'down'">
            <!-- 1. Opción Image -->
        <li (click)="selectOption('image')" class="dropdown-item">
          <span>Image</span>
          <!-- Botón Edit solo si hay config -->
          <button *ngIf="hasImageConfig()" 
                  class="edit-btn" 
                  (click)="onEditTool('image'); $event.stopPropagation()">
            ⚙
          </button>
        </li>

        <!-- 2. Opción MCP -->
        <li (click)="selectOption('mcp')" class="dropdown-item">
          <span>MCP</span>
          <button *ngIf="hasMcpConfig()" 
                  class="edit-btn" 
                  (click)="onEditTool('mcp'); $event.stopPropagation()">
            ⚙
          </button>
        </li>
      </ul>
  </div>
</ng-template>

  <input 
    type="text" 
    class="input-text"
    [placeholder]="placeholder"
    [value]="message"
    [disabled]="disabled"
    (input)="onInputChange($event)" 
    (keydown)="onKeyDown($event)"
    #inputText>
  <button 
    class="send-button"
    (click)="onSendMessage()" 
    [disabled]="isSending || disabled || !message.trim()">
    <div class="spinner" *ngIf="isSending"></div>
    <span *ngIf="!isSending">{{ sendButtonText }}</span>
  </button>
</div>